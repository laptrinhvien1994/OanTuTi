<div id="viewport" ng-controller="MainController">
    <button ng-if="!isOpening" id="tao-don-hang" ng-click="openPanel()"><i class="fa fa-desktop"></i> SUNO POS</button>
    <div class="pos-panel" ng-style="panel" style="position: fixed;">
        <button class="close" ng-click="closePanel()"><i class="fa fa-power-off"></i> <small>Đóng</small></button>

        <div class="pos-header">
            <p ng-if="userSession" style="cursor: pointer;" ng-click="showHideMenu()">{{userSession.displayName}}</p>

                <!--div Logout PopOver-->
                <div ng-if="isShowMenu" class="uiContextualLayer _5v-0 _53il uiContextualLayerBelowRight" style="right: 10px; top: 25px; z-index: 1000;">
                    <div class="_54nq _9jo _558b _2n_z" id="BLUE_BAR_ID_DO_NOT_USE">
                        <div class="_54ng">
                            <div class="uiScrollableArea fade uiScrollableAreaWithShadow">
                                <div class="uiScrollableAreaWrap scrollable" id="js_10f" style="max-height: 500px;">
                                    <div class="uiScrollableAreaBody" style="margin-right: -17px;">
                                        <div class="uiScrollableAreaContent">
                                            <ul class="_54nf" role="menu">
                                                <li class="_54ni navSubmenu __MenuItem" role="presentation">
                                                    <a class="_54nc" role="menuitem">
                                                        <span>
                                                              <span class="_54nh">Tạo đơn hàng</span>
                                                        </span>
                                                    </a>
                                                </li>
                                                <li class="_54ak __MenuItem" role="separator"></li>
                                                <li class="_54ni navSubmenu __MenuItem" role="presentation">
                                                    <a class="_54nc" href="#" role="menuitem">
                                                        <span>
                                                              <span class="_54nh">Tạo khách hàng</span>
                                                        </span>
                                                    </a>
                                                </li>
                                                <li class="_54ak __MenuItem" role="separator"></li>
                                                <li class="_54ni navSubmenu __MenuItem" role="presentation">
                                                    <a class="_54nc" href="https://pos.suno.vn" target="_blank" role="menuitem">
                                                        <span>
                                                              <span class="_54nh">Quản lý</span>
                                                        </span>
                                                    </a>
                                                </li>
                                                <li class="_54ak __MenuItem" role="separator"></li>
                                                <li class="_54ni navSubmenu __MenuItem" role="presentation">
                                                    <a class="_54nc" href="#" role="menuitem">
                                                        <span>
                                                              <span class="_54nh">
                                                                    Đăng xuất
                                                              </span>
                                                        </span>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="uiScrollableAreaTrack hidden_elem" style="opacity: 0;">
                                    <div class=""> </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <i class="_53io" style="left: 100%; margin-left: -28px;"></i>
                </div>
                <!--End div Logout PopOver-->


        </div>

        <div class="pos-body">
            <!-- Bảng thông báo -->
            <div class="notification-panel {{nClass}}" ng-if="nActived">
                <div class="n-header">
                    {{n.header}}
                </div>
                <div class="n-body">
                    {{n.body}}
                </div>
            </div>
            <!-- Bắt đầu màn hình POS -->
            <!-- Màn hình Login -->
            <div ng-if="!userSession">
                <div class="form-control">
                    <h3 class="margin-bottom-10">Đăng nhập</h3>
                    <p>Email / Mã đăng nhập</p>
                    <div>
                        <input type="text" name="username" ng-model="username" autocomplete="off">
                    </div>
                    <p>Mật khẩu</p>
                    <div class="margin-bottom-10">
                        <input type="password" name="password" ng-model='password' autocomplete="off">
                    </div>
                    <div>
                        <button class="btn btn-login" ng-click="login(username,password)">Đăng nhập</button>
                    </div>
                </div>
            </div>

            <!-- Màn hình POS -->
            <div ng-if="userSession">
                <!--<div class="product-search">
                    <label class="item-input-wrapper">
                        <i class="fa fa-search"></i>
                        <input type="text" name="search" ng-model="searchKey" placeholder="Tìm hàng hóa ... " autocomplete="off" ng-change="get_search_rs(searchKey)">
                        <i class="fa fa-close" ng-show="searchKey" ng-click="searchKey = null"></i>
                    </label>
                </div>
                <ul class="search-result" ng-show="searchKey">
                    <li ng-repeat="p in searchList.items" ng-click="pickProduct(p)">
                        <div><b>{{p.itemName}}</b></div>
                        <div>
                            <span>{{p.barcode}}</span> | 
                            <span>Tồn: {{p.qtyAvailable}}</span> | 
                            <span>{{p.retailPrice | number}}</span>
                        </div>
                    </li>
                </ul>-->
                <autocomplete attr-id="suggestProduct" attr-inputid="txtSuggestProduct" ng-model="searchKey" template-id="SuggestProductTemplate" attr-placeholder="Tìm kiếm hàng hóa" on-select="pickProduct" on-type="get_search_rs" on-focus="focusInput" data="searchList.items"></autocomplete>
                <script type="text/x-angular-template" id="SuggestProductTemplate">
                    <li suggestion ng-repeat="item in suggestions track by $index" index="{{ $index }}" val="{{item}}" ng-class="{ active: ($index === selectedIndex) }" ng-click="select(item)" style="cursor:pointer;">
                        <table class="width-100">
                            <tbody>
                                <tr>
                                    <td rowspan="2"><img width="31" height="31" style="border: 1px solid #e2e2e2" ng-src="{{item.img}}"/></td>
                                    <td class="text-left">
                                        <b>{{item.itemName | charLimit:27}}
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-right nowrap" style="padding-left: 3px;">
                                        Giá: <b>{{item.retailPrice}}</b> | Số lượng: <b>{{item.qtyAvailable}}</b>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </li>
                </script>
                <div id="pos-orders" ng-if="selectedOrder.saleOrder.orderDetails.length > 0">
                    <ul class="mCustomScrollbar" data-mcs-axis="y">
                        <li ng-repeat="item in selectedOrder.saleOrder.orderDetails" class="items-in-orderList" ng-mouseleave="itemLeave($event)" ng-mouseover="itemHover($event)">
                            <div class="item-name">
                                <a ng-href="https://pos.suno.vn/Manage/#/product/detail/{{item.productId}}" target="_blank" title="{{item.itemName}}">{{item.itemName | charLimit:33}}</a>
                            </div>
                            <div>
                                <span class="color-1">Đơn giá: {{item.retailPrice | number}}</span>
                            </div>
                            <div>
                                <span class="color-1">Số lượng: <input class="item-quantity" type="number" min="1" max="999" ng-model="item.quantity" ng-change="quantityChange(item)"/> </span>
                            </div>
                            <div>
                                <span class="color-1">Thành tiền: <b class="sum">{{item.retailPrice * item.quantity | number}}</b></span>&nbsp;&nbsp;
                                <span class="img-gift" id="id_{{item.itemId}}" ng-click="showHideDiscountPopOver(item)" title="Giảm giá sản phẩm"><img width="14" height="14" src="https://emojipedia-us.s3.amazonaws.com/thumbs/120/facebook/111/wrapped-present_1f381.png"/></span>
                            </div>
                            <div class="remove-button" ng-click="removeItem(item)"></div>
                        </li>
                        <div class="mypopover" id="popover2" ng-show="isOpenDiscountPopOver">
                            <div class="triangle"></div>
                            <div class="popover-content"></div>
                        </div>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>